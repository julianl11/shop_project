<!DOCTYPE html>
    <html>
    <head>
        <title>Ihr Warenkorb | The F√§ncy Brownie Co.</title>
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <style>
            @import url('https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;700&family=Lato:wght@300;400&display=swap');
            body {
                font-family: 'Lato', sans-serif;
                background-color: #f7f3e8;
                color: #3e2723;
                margin: 0;
                padding: 40px 20px;
                display: flex;
                flex-direction: column;
                align-items: center;
            }
            header { margin-bottom: 40px; text-align: center; }
            h1 {
                font-family: 'Playfair Display', serif;
                font-size: 3em;
                color: #5d4037;
                letter-spacing: 2px;
                margin-bottom: 5px;
            }
            .tagline { font-style: italic; color: #8d6e63; margin-top: 0; font-size: 1.1em; }
            .cart-summary {
                width: 100%;
                max-width: 800px;
                background: #fff;
                padding: 30px 40px;
                border-radius: 12px;
                box-shadow: 0 6px 20px rgba(0, 0, 0, 0.15);
                text-align: left;
            }
            h2 {
                font-family: 'Playfair Display', serif;
                color: #4e342e;
                border-bottom: 2px solid #efebe9;
                padding-bottom: 10px;
                margin-top: 0;
                margin-bottom: 20px;
            }
            .cart-item {
                display: flex;
                justify-content: space-between;
                align-items: center;
                padding: 15px 0;
                border-bottom: 1px dashed #efebe9;
            }
            .cart-item:last-of-type { border-bottom: none; }
            .item-details { flex-grow: 1; }
            .item-details h4 { margin: 0 0 5px 0; color: #5d4037; font-size: 1.1em; }
            .item-details .description { font-size: 0.9em; color: #8d6e63; margin: 0; }
            .item-details .quantity {font-size: 0.9em; color: #3e2723; margin: 5px 0 0; font-weight: bold; }
            .item-price { font-size: 1.3em; color: #4e342e; }
            .second-chance { background-color: #fcf8f0; padding: 10px; margin: 5px 0; border-radius: 4px; border-left: 3px solid #bcaaa4; }
            .second-chance-title { color: #7a5a4c !important; font-size: 1em !important; font-weight: bold; }
            .totals {
                margin-top: 30px;
                padding-top: 20px;
                border-top: 2px solid #5d4037;
                text-align: right;
            }
            .totals p { margin: 5px 0; font-size: 1.1em; }
            .totals strong { font-size: 1.5em; color: #4e342e; }
            .actions {
                display: flex;
                justify-content: space-between;
                margin-top: 30px;
            }
            .btn {
                padding: 12px 25px;
                border-radius: 6px;
                text-decoration: none;
                font-weight: 700;
                transition: background-color 0.3s;
                font-size: 1em;
            }
            .btn-back {
                background-color: #bcaaa4;
                color: white;
            }
            .btn-back:hover { background-color: #8d6e63; }
            .btn-checkout {
                background-color: #5d4037;
                color: white;
            }
            .btn-checkout:hover { background-color: #4e342e; }
            .empty-cart {
                text-align: center; 
                padding: 40px; 
                font-size: 1.2em; 
                color: #8d6e63; 
            }
            @media (max-width: 600px) {
                .cart-summary { padding: 20px; }
                .actions { flex-direction: column; gap: 15px; }
                .btn { width: 100%; text-align: center; }
            }

            .cart-item {
                /* Muss Platz f√ºr die neuen Buttons schaffen */
                gap: 15px; 
            }

            .quantity-form {
                display: flex;
                align-items: center;
                margin-right: 20px;
                width: 110px; /* Feste Breite f√ºr das Input-Feld */
            }

            .qty-input {
                width: 50px;
                padding: 6px;
                border: 1px solid #bcaaa4;
                border-radius: 4px 0 0 4px; /* Linke Seite rund */
                text-align: center;
                box-sizing: border-box;
                font-size: 1em;
            }
            
            .btn-update {
                background-color: #8d6e63; /* Kupferbraun */
                color: white;
                border: none;
                padding: 6px 10px;
                font-size: 1em;
                cursor: pointer;
                border-radius: 0 4px 4px 0; /* Rechte Seite rund */
                transition: background-color 0.3s;
                height: 33px; /* Angleichen an Input-H√∂he */
            }
            
            .btn-update:hover {
                background-color: #7a5a4c;
            }

            .remove-form {
                margin-left: 20px; /* Abstand zum Preis */
            }

            .btn-remove {
                background-color: #e57373; /* Sanftes Rot */
                color: white;
                border: none;
                padding: 6px 10px;
                font-size: 1.2em;
                cursor: pointer;
                border-radius: 4px;
                transition: background-color 0.3s;
                line-height: 1;
                height: 33px; 
            }

            .btn-remove:hover {
                background-color: #d32f2f; /* Dunkleres Rot */
            }

            .item-price {
                /* Sicherstellen, dass der Preis rechts neben dem Update-Formular steht */
                flex-shrink: 0;
            }

            .second-chance .quantity-form {
                /* Second-Chance Artikel k√∂nnen hier nicht bearbeitet werden */
                display: none; 
            }

            .discount-info { 
                color: #d32f2f; /* Rot f√ºr den Rabatt */
                font-weight: bold; 
                margin: 5px 0 0; 
                font-size: 0.9em;
            }
            
            .original-price {
                text-decoration: line-through;
                color: #8d6e63;
                font-weight: normal;
            }
            
            .totals {
                /* ... */
                position: relative; /* F√ºr die Platzierung des Sparhinweises */
            }
            
            .savings-banner {
                background-color: #e8f5e9; /* Helles Gr√ºn */
                color: #388e3c; /* Dunkelgr√ºn */
                padding: 10px 20px;
                margin-top: 10px;
                border-radius: 4px;
                font-weight: bold;
                font-size: 1.2em;
                text-align: right;
                border: 1px solid #c8e6c9;
            }
            
            /* NEU: Anpassung f√ºr die Second-Chance Anzeige */
            .second-chance-title {
                color: #7a5a4c !important; 
                font-size: 1em !important; 
                font-weight: bold;
            }
            .second-chance .unit-price-info {
                font-size: 0.9em;
            }

            /* Responsive Anpassung f√ºr Mobilger√§te */
            @media (max-width: 600px) {
                .cart-item {
                    flex-wrap: wrap;
                    justify-content: flex-start;
                }
                .quantity-form, .remove-form {
                    margin-top: 10px;
                    order: 3; /* Unten positionieren */
                }
                .item-price {
                    order: 2;
                    margin-left: auto; /* Preis rechts b√ºndig */
                }
            }
        </style>
    </head>
<body>
        <header>
            <h1>Ihr Warenkorb</h1>
            <p class="tagline">Ein Schritt entfernt von Ihrem f√§ncigen Brownie-Gl√ºck.</p>
        </header>

        <div class="cart-summary"> 
            
            <h2>Ihre Artikel ({{ len_cart_items | safe }})</h2>

            <div class="item-list">
                {{items_html |safe}}
            </div>
            
            <div class="totals">
                {% if total_savings_str and total_savings_str != '0,00' %}
                <p class="savings-banner">
                    üéâ Ihre Ersparnis: {{ total_savings_str | safe }} ‚Ç¨
                </p>
                {% endif %}
                
                <p>Zwischensumme: {{totals['subtotal'] |safe }} ‚Ç¨</p>
                <p>Versandkosten: {{totals['shipping'] |safe }} ‚Ç¨</p>
                <p>Gesch√§tzte MwSt (19%): {{totals['tax'] |safe }} ‚Ç¨</p>
                <h3>Gesamtsumme: <strong>{{grand_total_str |safe }} ‚Ç¨</strong></h3>
            </div>
            
            <div class="actions">
                <a href="/shop" class="btn btn-back">‚Üê Weiter bestellen</a>
                <a href="/checkout" class="btn btn-checkout">Zur Kasse gehen</a>
            </div>
        </div> </body>
    </html>